<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DiaLife Pro - AI Í∏∞Î∞ò 1ÌòïÎãπÎá®Î≥ë Í¥ÄÎ¶¨</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .pulse-green { animation: pulseGreen 2s infinite; }
        @keyframes pulseGreen { 0%, 100% { background-color: rgb(34, 197, 94); } 50% { background-color: rgb(22, 163, 74); } }
        .icon { display: inline-block; width: 1em; height: 1em; vertical-align: middle; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Í∞ÑÎã®Ìïú ÏïÑÏù¥ÏΩò Ïª¥Ìè¨ÎÑåÌä∏Îì§
        const Heart = () => React.createElement('span', { className: 'icon' }, '‚ù§Ô∏è');
        const Droplets = () => React.createElement('span', { className: 'icon' }, 'üíß');
        const Brain = () => React.createElement('span', { className: 'icon' }, 'üß†');
        const Target = () => React.createElement('span', { className: 'icon' }, 'üéØ');
        const BarChart3 = () => React.createElement('span', { className: 'icon' }, 'üìä');
        const Save = () => React.createElement('span', { className: 'icon' }, 'üíæ');
        const LogOut = () => React.createElement('span', { className: 'icon' }, 'üö™');
        const Bot = () => React.createElement('span', { className: 'icon' }, 'ü§ñ');
        const Bell = () => React.createElement('span', { className: 'icon' }, 'üîî');
        const AlertTriangle = () => React.createElement('span', { className: 'icon' }, '‚ö†Ô∏è');
        const Sparkles = () => React.createElement('span', { className: 'icon' }, '‚ú®');

        const DiabetesManagementApp = () => {
            const [currentUser, setCurrentUser] = useState(null);
            const [authMode, setAuthMode] = useState('login');
            const [authData, setAuthData] = useState({ username: '', password: '', confirmPassword: '' });
            const [bloodSugar, setBloodSugar] = useState('');
            const [carbs, setCarbs] = useState('');
            const [insulinDose, setInsulinDose] = useState(0);
            const [mealType, setMealType] = useState('breakfast');
            const [isLoading, setIsLoading] = useState(false);
            const [aiResponse, setAiResponse] = useState('');
            const [showAiChat, setShowAiChat] = useState(false);
            const [chatInput, setChatInput] = useState('');
            const [notifications, setNotifications] = useState([]);

            const saveToStorage = (key, data) => {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                    return true;
                } catch (error) {
                    return false;
                }
            };

            const loadFromStorage = (key) => {
                try {
                    const data = localStorage.getItem(key);
                    return data ? JSON.parse(data) : null;
                } catch (error) {
                    return null;
                }
            };

            const [userDatabase, setUserDatabase] = useState(() => {
                return loadFromStorage('diabetesApp_users') || {};
            });

            const [userSettings, setUserSettings] = useState({
                carbRatio: 10,
                correctionFactor: 50,
                targetBG: 120,
                weight: 70,
                insulinType: 'rapid',
                notifications: true,
                autoUpdate: true
            });

            const [personalData, setPersonalData] = useState({
                bloodSugars: [],
                insulin: [],
                stats: {
                    avgBG: 0,
                    timeInRange: 0,
                    totalRecords: 0
                }
            });

            const addNotification = (type, title, message) => {
                const notification = {
                    id: Date.now(),
                    type,
                    title,
                    message,
                    timestamp: new Date().toISOString(),
                    read: false
                };
                setNotifications(prev => [...prev, notification]);
            };

            const handleAuth = () => {
                if (authMode === 'register') {
                    if (authData.password !== authData.confirmPassword) {
                        alert('ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§.');
                        return;
                    }
                    if (userDatabase[authData.username]) {
                        alert('Ïù¥ÎØ∏ Ï°¥Ïû¨ÌïòÎäî ÏÇ¨Ïö©ÏûêÎ™ÖÏûÖÎãàÎã§.');
                        return;
                    }

                    const newUser = {
                        username: authData.username,
                        password: authData.password,
                        createdDate: new Date().toISOString(),
                        settings: { ...userSettings },
                        data: { ...personalData }
                    };

                    const updatedDatabase = {
                        ...userDatabase,
                        [authData.username]: newUser
                    };

                    setUserDatabase(updatedDatabase);
                    setCurrentUser(newUser);
                    saveToStorage('diabetesApp_users', updatedDatabase);
                    saveToStorage('diabetesApp_lastUser', authData.username);
                    addNotification('info', 'ÌöåÏõêÍ∞ÄÏûÖ ÏôÑÎ£å!', `${authData.username}Îãò, ÌôòÏòÅÌï©ÎãàÎã§!`);
                } else {
                    const user = userDatabase[authData.username];
                    if (!user || user.password !== authData.password) {
                        alert('ÏÇ¨Ïö©ÏûêÎ™Ö ÎòêÎäî ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§.');
                        return;
                    }
                    setCurrentUser(user);
                    setUserSettings(user.settings);
                    setPersonalData(user.data);
                    saveToStorage('diabetesApp_lastUser', authData.username);
                    addNotification('info', 'Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ!', `${user.username}Îãò, ÌôòÏòÅÌï©ÎãàÎã§!`);
                }
                setAuthData({ username: '', password: '', confirmPassword: '' });
            };

            const addBloodSugarRecord = (value) => {
                const record = {
                    id: Date.now(),
                    value: parseFloat(value),
                    timestamp: new Date().toISOString()
                };

                setPersonalData(prev => ({
                    ...prev,
                    bloodSugars: [...prev.bloodSugars, record],
                    stats: {
                        ...prev.stats,
                        totalRecords: prev.stats.totalRecords + 1
                    }
                }));

                if (parseFloat(value) < 70) {
                    addNotification('critical', 'Ï†ÄÌòàÎãπ Í≤ΩÍ≥†', `ÌòàÎãπ ${value}mg/dL - Ï¶âÏãú Ìè¨ÎèÑÎãπ ÏÑ≠Ï∑®ÌïòÏÑ∏Ïöî!`);
                } else if (parseFloat(value) > 300) {
                    addNotification('critical', 'Ïã¨Í∞ÅÌïú Í≥†ÌòàÎãπ', `ÌòàÎãπ ${value}mg/dL - Ï¶âÏãú ÏùòÎ£åÏßÑÏóêÍ≤å Ïó∞ÎùΩÌïòÏÑ∏Ïöî!`);
                }
            };

            const calculateInsulinDose = () => {
                if (!carbs || !bloodSugar) return;
                const carbsNum = parseFloat(carbs);
                const bgNum = parseFloat(bloodSugar);
                const mealInsulin = carbsNum / userSettings.carbRatio;
                let correctionInsulin = 0;
                if (bgNum > userSettings.targetBG) {
                    correctionInsulin = (bgNum - userSettings.targetBG) / userSettings.correctionFactor;
                }
                const totalDose = Math.round((mealInsulin + correctionInsulin) * 10) / 10;
                setInsulinDose(totalDose);
            };

            const evaluateBloodSugar = (bg) => {
                const bgNum = parseFloat(bg);
                if (bgNum < 70) return { color: 'text-red-600', action: 'Ï¶âÏãú Ìè¨ÎèÑÎãπ 15g ÏÑ≠Ï∑® ÌïÑÏöî' };
                if (bgNum < 80) return { color: 'text-orange-500', action: 'Ï£ºÏùò Í¥ÄÏ∞∞ ÌïÑÏöî' };
                if (bgNum <= 180) return { color: 'text-green-600', action: 'Î™©Ìëú Î≤îÏúÑ ÎÇ¥' };
                if (bgNum < 250) return { color: 'text-orange-500', action: 'ÍµêÏ†ï Ïù∏ÏäêÎ¶∞ Í≥†Î†§' };
                return { color: 'text-red-600', action: 'Ï¶âÏãú ÏùòÎ£åÏßÑ ÏÉÅÎã¥ ÌïÑÏöî' };
            };

            // ÏûêÎèô Î°úÍ∑∏Ïù∏
            useEffect(() => {
                const lastUser = loadFromStorage('diabetesApp_lastUser');
                if (lastUser && userDatabase[lastUser]) {
                    const user = userDatabase[lastUser];
                    setCurrentUser(user);
                    setUserSettings(user.settings);
                    setPersonalData(user.data);
                }
            }, [userDatabase]);

            const handleLogout = () => {
                localStorage.removeItem('diabetesApp_lastUser');
                setCurrentUser(null);
                setNotifications([]);
            };

            // Î°úÍ∑∏Ïù∏ ÌôîÎ©¥
            if (!currentUser) {
                return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center" },
                    React.createElement('div', { className: "bg-white p-8 rounded-2xl shadow-xl border max-w-md w-full" },
                        React.createElement('div', { className: "text-center mb-8" },
                            React.createElement('div', { className: "bg-blue-600 p-3 rounded-xl inline-block mb-4" },
                                React.createElement(Heart)
                            ),
                            React.createElement('h1', { className: "text-2xl font-bold text-gray-800" }, "DiaLife Pro AI"),
                            React.createElement('p', { className: "text-gray-600" }, "AI Í∏∞Î∞ò Í∞úÏù∏ÌôîÎêú 1ÌòïÎãπÎá®Î≥ë Í¥ÄÎ¶¨")
                        ),
                        React.createElement('div', { className: "space-y-6" },
                            React.createElement('div', { className: "flex bg-gray-100 rounded-lg p-1" },
                                React.createElement('button', {
                                    onClick: () => setAuthMode('login'),
                                    className: `flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${
                                        authMode === 'login' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-600'
                                    }`
                                }, "Î°úÍ∑∏Ïù∏"),
                                React.createElement('button', {
                                    onClick: () => setAuthMode('register'),
                                    className: `flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${
                                        authMode === 'register' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-600'
                                    }`
                                }, "ÌöåÏõêÍ∞ÄÏûÖ")
                            ),
                            React.createElement('div', { className: "space-y-4" },
                                React.createElement('input', {
                                    type: "text",
                                    value: authData.username,
                                    onChange: (e) => setAuthData(prev => ({ ...prev, username: e.target.value })),
                                    className: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",
                                    placeholder: "ÏÇ¨Ïö©ÏûêÎ™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
                                }),
                                React.createElement('input', {
                                    type: "password",
                                    value: authData.password,
                                    onChange: (e) => setAuthData(prev => ({ ...prev, password: e.target.value })),
                                    className: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",
                                    placeholder: "ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
                                }),
                                authMode === 'register' && React.createElement('input', {
                                    type: "password",
                                    value: authData.confirmPassword,
                                    onChange: (e) => setAuthData(prev => ({ ...prev, confirmPassword: e.target.value })),
                                    className: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",
                                    placeholder: "ÎπÑÎ∞ÄÎ≤àÌò∏Î•º Îã§Ïãú ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
                                })
                            ),
                            React.createElement('button', {
                                onClick: handleAuth,
                                className: "w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-medium transition-colors"
                            }, authMode === 'login' ? 'Î°úÍ∑∏Ïù∏' : 'ÌöåÏõêÍ∞ÄÏûÖ')
                        )
                    )
                );
            }

            // Î©îÏù∏ Ïï± ÌôîÎ©¥
            return React.createElement('div', { className: "min-h-screen bg-gray-50" },
                React.createElement('header', { className: "bg-white shadow-sm border-b" },
                    React.createElement('div', { className: "max-w-6xl mx-auto px-4 py-4" },
                        React.createElement('div', { className: "flex items-center justify-between" },
                            React.createElement('div', { className: "flex items-center gap-3" },
                                React.createElement(Heart),
                                React.createElement('h1', { className: "text-xl font-bold text-gray-800" }, "DiaLife Pro AI")
                            ),
                            React.createElement('button', {
                                onClick: handleLogout,
                                className: "flex items-center gap-2 bg-gray-100 text-gray-700 px-3 py-2 rounded-lg text-sm hover:bg-gray-200 transition-colors"
                            },
                                React.createElement(LogOut),
                                "Î°úÍ∑∏ÏïÑÏõÉ"
                            )
                        )
                    )
                ),

                React.createElement('main', { className: "max-w-6xl mx-auto px-4 py-8" },
                    // ÌÜµÍ≥Ñ Ïπ¥Îìú
                    React.createElement('div', { className: "grid md:grid-cols-4 gap-4 mb-6" },
                        React.createElement('div', { className: "bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-2xl border" },
                            React.createElement('div', { className: "flex items-center justify-between" },
                                React.createElement('div', null,
                                    React.createElement('p', { className: "text-blue-600 font-medium" }, "ÌèâÍ∑† ÌòàÎãπ"),
                                    React.createElement('p', { className: "text-3xl font-bold text-blue-800" }, personalData.stats.avgBG || 124),
                                    React.createElement('p', { className: "text-sm text-blue-600" }, "mg/dL")
                                ),
                                React.createElement(Droplets)
                            )
                        ),
                        React.createElement('div', { className: "bg-gradient-to-br from-emerald-50 to-emerald-100 p-6 rounded-2xl border" },
                            React.createElement('div', { className: "flex items-center justify-between" },
                                React.createElement('div', null,
                                    React.createElement('p', { className: "text-emerald-600 font-medium" }, "Î™©Ìëú Î≤îÏúÑ"),
                                    React.createElement('p', { className: "text-3xl font-bold text-emerald-800" }, `${personalData.stats.timeInRange || 78}%`),
                                    React.createElement('p', { className: "text-sm text-emerald-600" }, "ÏãúÍ∞Ñ")
                                ),
                                React.createElement(Target)
                            )
                        ),
                        React.createElement('div', { className: "bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-2xl border" },
                            React.createElement('div', { className: "flex items-center justify-between" },
                                React.createElement('div', null,
                                    React.createElement('p', { className: "text-purple-600 font-medium" }, "Ï¥ù Í∏∞Î°ù"),
                                    React.createElement('p', { className: "text-3xl font-bold text-purple-800" }, personalData.stats.totalRecords || 0),
                                    React.createElement('p', { className: "text-sm text-purple-600" }, "Ìöå")
                                ),
                                React.createElement(BarChart3)
                            )
                        ),
                        React.createElement('div', { className: "bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-2xl border" },
                            React.createElement('div', { className: "flex items-center justify-between" },
                                React.createElement('div', null,
                                    React.createElement('p', { className: "text-orange-600 font-medium" }, "AI ÌïôÏäµ"),
                                    React.createElement('p', { className: "text-3xl font-bold text-orange-800" }, `1:${userSettings.carbRatio}`),
                                    React.createElement('p', { className: "text-sm text-orange-600" }, "ÌÉÑÏàòÌôîÎ¨º")
                                ),
                                React.createElement(Brain)
                            )
                        )
                    ),

                    // Îπ†Î•∏ ÏûÖÎ†• Ìå®ÎÑê
                    React.createElement('div', { className: "bg-white p-6 rounded-2xl shadow-lg border mb-6" },
                        React.createElement('h3', { className: "text-lg font-bold text-gray-800 mb-4" }, "Îπ†Î•∏ Í∏∞Î°ù ÏûÖÎ†•"),
                        React.createElement('div', { className: "grid md:grid-cols-2 gap-6" },
                            React.createElement('div', { className: "space-y-4" },
                                React.createElement('h4', { className: "font-semibold text-gray-700" }, "ÌòàÎãπ Í∏∞Î°ù"),
                                React.createElement('div', { className: "flex gap-2" },
                                    React.createElement('input', {
                                        type: "number",
                                        value: bloodSugar,
                                        onChange: (e) => setBloodSugar(e.target.value),
                                        placeholder: "ÌòàÎãπ (mg/dL)",
                                        className: "flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                    }),
                                    React.createElement('button', {
                                        onClick: () => {
                                            if (bloodSugar) {
                                                addBloodSugarRecord(bloodSugar);
                                                setBloodSugar('');
                                            }
                                        },
                                        className: "bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg"
                                    }, "Í∏∞Î°ù")
                                ),
                                bloodSugar && React.createElement('p', { className: `text-sm ${evaluateBloodSugar(bloodSugar).color}` },
                                    evaluateBloodSugar(bloodSugar).action
                                )
                            ),

                            React.createElement('div', { className: "space-y-4" },
                                React.createElement('h4', { className: "font-semibold text-gray-700" }, "Ïù∏ÏäêÎ¶∞ Í≥ÑÏÇ∞"),
                                React.createElement('div', { className: "flex gap-2" },
                                    React.createElement('input', {
                                        type: "number",
                                        value: carbs,
                                        onChange: (e) => setCarbs(e.target.value),
                                        placeholder: "ÌÉÑÏàòÌôîÎ¨º (g)",
                                        className: "flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                    }),
                                    React.createElement('button', {
                                        onClick: calculateInsulinDose,
                                        className: "bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg"
                                    }, "Í≥ÑÏÇ∞")
                                ),
                                insulinDose > 0 && React.createElement('div', { className: "bg-gray-50 p-3 rounded-lg" },
                                    React.createElement('p', { className: "font-semibold text-blue-600" }, `Í∂åÏû• Ïö©Îüâ: ${insulinDose} Îã®ÏúÑ`)
                                )
                            )
                        )
                    ),

                    // ÏµúÍ∑º Í∏∞Î°ù
                    React.createElement('div', { className: "bg-white p-6 rounded-2xl shadow-lg border" },
                        React.createElement('h4', { className: "font-semibold text-gray-800 mb-4" }, "ÏµúÍ∑º ÌòàÎãπ Í∏∞Î°ù"),
                        React.createElement('div', { className: "space-y-3" },
                            personalData.bloodSugars.length > 0 ? personalData.bloodSugars.slice(-5).reverse().map((record, index) =>
                                React.createElement('div', { 
                                    key: record.id || index, 
                                    className: "flex justify-between items-center p-3 bg-gray-50 rounded-lg"
                                },
                                    React.createElement('div', null,
                                        React.createElement('p', { className: "font-medium" }, `${record.value} mg/dL`),
                                        React.createElement('p', { className: "text-sm text-gray-600" }, 
                                            new Date(record.timestamp).toLocaleString()
                                        )
                                    )
                                )
                            ) : React.createElement('p', { className: "text-gray-500 text-center py-4" }, "ÏïÑÏßÅ Í∏∞Î°ùÏù¥ ÏóÜÏäµÎãàÎã§")
                        )
                    )
                )
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(DiabetesManagementApp));
    </script>
</body>
</html>
