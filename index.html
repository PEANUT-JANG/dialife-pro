<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DiaLife Pro - ÎãπÎá®Î≥ë Í¥ÄÎ¶¨</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .icon { display: inline-block; width: 1em; height: 1em; vertical-align: middle; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const Heart = () => React.createElement('span', { className: 'icon' }, '‚ù§Ô∏è');
        const Settings = () => React.createElement('span', { className: 'icon' }, '‚öôÔ∏è');
        const LogOut = () => React.createElement('span', { className: 'icon' }, 'üö™');
        const Edit = () => React.createElement('span', { className: 'icon' }, '‚úèÔ∏è');
        const Trash = () => React.createElement('span', { className: 'icon' }, 'üóëÔ∏è');
        const Check = () => React.createElement('span', { className: 'icon' }, '‚úÖ');
        const X = () => React.createElement('span', { className: 'icon' }, '‚ùå');

        const DiabetesApp = () => {
            const [currentUser, setCurrentUser] = useState(null);
            const [authMode, setAuthMode] = useState('login');
            const [authData, setAuthData] = useState({ username: '', password: '', confirmPassword: '' });
            const [bloodSugar, setBloodSugar] = useState('');
            const [notifications, setNotifications] = useState([]);
            const [editingRecord, setEditingRecord] = useState(null);
            const [showSettings, setShowSettings] = useState(false);

            const [userDatabase, setUserDatabase] = useState(() => {
                try {
                    const saved = localStorage.getItem('diabetesApp_users');
                    return saved ? JSON.parse(saved) : {};
                } catch {
                    return {};
                }
            });

            const [userSettings, setUserSettings] = useState({
                targetMin: 80,
                targetMax: 180
            });

            const [personalData, setPersonalData] = useState({
                bloodSugars: [],
                stats: { totalRecords: 0 }
            });

            const saveToStorage = (key, data) => {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                } catch (error) {
                    console.error('Save failed:', error);
                }
            };

            const addNotification = (type, title, message) => {
                const notification = {
                    id: Date.now(),
                    type,
                    title,
                    message
                };
                setNotifications(prev => [...prev, notification]);
                setTimeout(() => {
                    setNotifications(prev => prev.filter(n => n.id !== notification.id));
                }, 3000);
            };

            const updateUserData = (newData) => {
                if (!currentUser) return;
                
                const updatedUser = {
                    ...currentUser,
                    settings: userSettings,
                    data: newData
                };

                const updatedDatabase = {
                    ...userDatabase,
                    [currentUser.username]: updatedUser
                };

                setUserDatabase(updatedDatabase);
                setCurrentUser(updatedUser);
                saveToStorage('diabetesApp_users', updatedDatabase);
            };

            const handleAuth = () => {
                if (authMode === 'register') {
                    if (authData.password !== authData.confirmPassword) {
                        alert('ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§.');
                        return;
                    }
                    if (userDatabase[authData.username]) {
                        alert('Ïù¥ÎØ∏ Ï°¥Ïû¨ÌïòÎäî ÏÇ¨Ïö©ÏûêÎ™ÖÏûÖÎãàÎã§.');
                        return;
                    }

                    const newUser = {
                        username: authData.username,
                        password: authData.password,
                        settings: userSettings,
                        data: personalData
                    };

                    const updatedDatabase = {
                        ...userDatabase,
                        [authData.username]: newUser
                    };

                    setUserDatabase(updatedDatabase);
                    setCurrentUser(newUser);
                    saveToStorage('diabetesApp_users', updatedDatabase);
                    addNotification('success', 'ÌôòÏòÅÌï©ÎãàÎã§!', 'ÌöåÏõêÍ∞ÄÏûÖÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.');
                } else {
                    const user = userDatabase[authData.username];
                    if (!user || user.password !== authData.password) {
                        alert('ÏÇ¨Ïö©ÏûêÎ™Ö ÎòêÎäî ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§.');
                        return;
                    }
                    setCurrentUser(user);
                    setUserSettings(user.settings || userSettings);
                    setPersonalData(user.data || personalData);
                    addNotification('success', 'ÌôòÏòÅÌï©ÎãàÎã§!', user.username + 'Îãò');
                }
                setAuthData({ username: '', password: '', confirmPassword: '' });
            };

            const addBloodSugarRecord = (value) => {
                const record = {
                    id: Date.now(),
                    value: parseFloat(value),
                    timestamp: new Date().toISOString()
                };

                const newData = {
                    ...personalData,
                    bloodSugars: [...personalData.bloodSugars, record],
                    stats: {
                        totalRecords: personalData.stats.totalRecords + 1
                    }
                };

                setPersonalData(newData);
                updateUserData(newData);

                const bgNum = parseFloat(value);
                if (bgNum < userSettings.targetMin) {
                    addNotification('warning', 'Ï†ÄÌòàÎãπ Ï£ºÏùò', 'Í∞ÑÏãùÏùÑ ÎìúÏÑ∏Ïöî!');
                } else if (bgNum > userSettings.targetMax) {
                    addNotification('warning', 'Í≥†ÌòàÎãπ Ï£ºÏùò', 'Î¨ºÏùÑ Ï∂©Î∂ÑÌûà ÎìúÏÑ∏Ïöî!');
                } else {
                    addNotification('success', 'Ï¢ãÏïÑÏöî!', 'Î™©Ìëú Î≤îÏúÑ ÏïàÏóê ÏûàÏäµÎãàÎã§!');
                }
            };

            const deleteRecord = (id) => {
                if (confirm('Ïù¥ Í∏∞Î°ùÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    const newData = {
                        ...personalData,
                        bloodSugars: personalData.bloodSugars.filter(record => record.id !== id),
                        stats: {
                            totalRecords: Math.max(0, personalData.stats.totalRecords - 1)
                        }
                    };
                    setPersonalData(newData);
                    updateUserData(newData);
                    addNotification('info', 'ÏÇ≠Ï†ú ÏôÑÎ£å', 'Í∏∞Î°ùÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.');
                }
            };

            const editRecord = (id, newValue) => {
                const newData = {
                    ...personalData,
                    bloodSugars: personalData.bloodSugars.map(record => 
                        record.id === id ? { ...record, value: parseFloat(newValue) } : record
                    )
                };
                setPersonalData(newData);
                updateUserData(newData);
                setEditingRecord(null);
                addNotification('success', 'ÏàòÏ†ï ÏôÑÎ£å', 'Í∏∞Î°ùÏù¥ ÏóÖÎç∞Ïù¥Ìä∏ÎêòÏóàÏäµÎãàÎã§.');
            };

            const getBGStatus = (bg) => {
                const bgNum = parseFloat(bg);
                if (bgNum < userSettings.targetMin) {
                    return { color: 'text-orange-600', bgColor: 'bg-orange-50', status: 'ÎÇÆÏùå' };
                }
                if (bgNum > userSettings.targetMax) {
                    return { color: 'text-red-600', bgColor: 'bg-red-50', status: 'ÎÜíÏùå' };
                }
                return { color: 'text-green-600', bgColor: 'bg-green-50', status: 'Ï¢ãÏùå' };
            };

            const handleLogout = () => {
                setCurrentUser(null);
                setNotifications([]);
                setShowSettings(false);
            };

            // Î°úÍ∑∏Ïù∏ ÌôîÎ©¥
            if (!currentUser) {
                return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center" },
                    React.createElement('div', { className: "bg-white p-8 rounded-2xl shadow-xl border max-w-md w-full" },
                        React.createElement('div', { className: "text-center mb-8" },
                            React.createElement('div', { className: "bg-blue-600 p-4 rounded-xl inline-block mb-4" },
                                React.createElement(Heart, { className: "text-3xl" })
                            ),
                            React.createElement('h1', { className: "text-2xl font-bold text-gray-800" }, "DiaLife Pro"),
                            React.createElement('p', { className: "text-gray-600 mt-2" }, "ÏâΩÍ≥† ÏïàÏ†ÑÌïú ÎãπÎá® Í¥ÄÎ¶¨")
                        ),
                        React.createElement('div', { className: "space-y-6" },
                            React.createElement('div', { className: "flex bg-gray-100 rounded-lg p-1" },
                                React.createElement('button', {
                                    onClick: () => setAuthMode('login'),
                                    className: `flex-1 py-3 px-4 rounded-md text-sm font-medium transition-colors ${
                                        authMode === 'login' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-600'
                                    }`
                                }, "Î°úÍ∑∏Ïù∏"),
                                React.createElement('button', {
                                    onClick: () => setAuthMode('register'),
                                    className: `flex-1 py-3 px-4 rounded-md text-sm font-medium transition-colors ${
                                        authMode === 'register' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-600'
                                    }`
                                }, "ÌöåÏõêÍ∞ÄÏûÖ")
                            ),
                            React.createElement('div', { className: "space-y-4" },
                                React.createElement('input', {
                                    type: "text",
                                    value: authData.username,
                                    onChange: (e) => setAuthData(prev => ({ ...prev, username: e.target.value })),
                                    className: "w-full px-4 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-lg",
                                    placeholder: "Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
                                }),
                                React.createElement('input', {
                                    type: "password",
                                    value: authData.password,
                                    onChange: (e) => setAuthData(prev => ({ ...prev, password: e.target.value })),
                                    className: "w-full px-4 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-lg",
                                    placeholder: "ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
                                }),
                                authMode === 'register' && React.createElement('input', {
                                    type: "password",
                                    value: authData.confirmPassword,
                                    onChange: (e) => setAuthData(prev => ({ ...prev, confirmPassword: e.target.value })),
                                    className: "w-full px-4 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-lg",
                                    placeholder: "ÎπÑÎ∞ÄÎ≤àÌò∏Î•º Îã§Ïãú ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
                                })
                            ),
                            React.createElement('button', {
                                onClick: handleAuth,
                                className: "w-full bg-blue-600 hover:bg-blue-700 text-white py-4 px-4 rounded-lg font-medium transition-colors text-lg"
                            }, authMode === 'login' ? 'Î°úÍ∑∏Ïù∏' : 'ÌöåÏõêÍ∞ÄÏûÖ')
                        )
                    )
                );
            }

            // ÏÑ§Ï†ï ÌôîÎ©¥
            if (showSettings) {
                return React.createElement('div', { className: "min-h-screen bg-gray-50" },
                    React.createElement('header', { className: "bg-white shadow-sm border-b" },
                        React.createElement('div', { className: "max-w-4xl mx-auto px-4 py-4" },
                            React.createElement('div', { className: "flex items-center justify-between" },
                                React.createElement('h1', { className: "text-xl font-bold text-gray-800" }, "ÏÑ§Ï†ï"),
                                React.createElement('button', {
                                    onClick: () => setShowSettings(false),
                                    className: "bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200"
                                }, "ÎèåÏïÑÍ∞ÄÍ∏∞")
                            )
                        )
                    ),
                    React.createElement('main', { className: "max-w-4xl mx-auto px-4 py-8" },
                        React.createElement('div', { className: "bg-white p-6 rounded-2xl shadow-lg border" },
                            React.createElement('h3', { className: "text-lg font-bold text-gray-800 mb-4" }, "ÌòàÎãπ Î™©Ìëú Î≤îÏúÑ"),
                            React.createElement('div', { className: "grid md:grid-cols-2 gap-4" },
                                React.createElement('div', null,
                                    React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, "ÏµúÏÜåÍ∞í (mg/dL)"),
                                    React.createElement('input', {
                                        type: "number",
                                        value: userSettings.targetMin,
                                        onChange: (e) => setUserSettings(prev => ({ ...prev, targetMin: parseInt(e.target.value) })),
                                        className: "w-full px-3 py-2 border border-gray-300 rounded-lg"
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, "ÏµúÎåÄÍ∞í (mg/dL)"),
                                    React.createElement('input', {
                                        type: "number",
                                        value: userSettings.targetMax,
                                        onChange: (e) => setUserSettings(prev => ({ ...prev, targetMax: parseInt(e.target.value) })),
                                        className: "w-full px-3 py-2 border border-gray-300 rounded-lg"
                                    })
                                )
                            ),
                            React.createElement('button', {
                                onClick: () => {
                                    updateUserData(personalData);
                                    addNotification('success', 'Ï†ÄÏû• ÏôÑÎ£å', 'ÏÑ§Ï†ïÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§');
                                },
                                className: "mt-4 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg"
                            }, "Ï†ÄÏû•")
                        )
                    )
                );
            }

            // Î©îÏù∏ ÌôîÎ©¥
            return React.createElement('div', { className: "min-h-screen bg-gray-50" },
                // ÏïåÎ¶º
                notifications.length > 0 && React.createElement('div', { className: "fixed top-4 right-4 z-50 space-y-2" },
                    notifications.map(notification =>
                        React.createElement('div', { 
                            key: notification.id, 
                            className: `p-4 rounded-lg shadow-lg border max-w-sm ${
                                notification.type === 'success' ? 'bg-green-50 border-green-200 text-green-800' :
                                notification.type === 'warning' ? 'bg-orange-50 border-orange-200 text-orange-800' :
                                'bg-blue-50 border-blue-200 text-blue-800'
                            } fade-in`
                        },
                            React.createElement('p', { className: "font-medium" }, notification.title),
                            React.createElement('p', { className: "text-sm mt-1" }, notification.message)
                        )
                    )
                ),

                // Ìó§Îçî
                React.createElement('header', { className: "bg-white shadow-sm border-b" },
                    React.createElement('div', { className: "max-w-6xl mx-auto px-4 py-4" },
                        React.createElement('div', { className: "flex items-center justify-between" },
                            React.createElement('div', { className: "flex items-center gap-3" },
                                React.createElement(Heart, { className: "text-2xl" }),
                                React.createElement('div', null,
                                    React.createElement('h1', { className: "text-xl font-bold text-gray-800" }, "DiaLife Pro"),
                                    React.createElement('p', { className: "text-sm text-gray-600" }, currentUser.username + 'ÎãòÏùò ÎãπÎá® Í¥ÄÎ¶¨')
                                )
                            ),
                            React.createElement('div', { className: "flex items-center gap-3" },
                                React.createElement('button', {
                                    onClick: () => setShowSettings(true),
                                    className: "flex items-center gap-2 bg-gray-100 text-gray-700 px-3 py-2 rounded-lg text-sm hover:bg-gray-200"
                                },
                                    React.createElement(Settings),
                                    "ÏÑ§Ï†ï"
                                ),
                                React.createElement('button', {
                                    onClick: handleLogout,
                                    className: "flex items-center gap-2 bg-gray-100 text-gray-700 px-3 py-2 rounded-lg text-sm hover:bg-gray-200"
                                },
                                    React.createElement(LogOut),
                                    "Î°úÍ∑∏ÏïÑÏõÉ"
                                )
                            )
                        )
                    )
                ),

                // Î©îÏù∏ ÏΩòÌÖêÏ∏†
                React.createElement('main', { className: "max-w-6xl mx-auto px-4 py-8" },
                    // ÌÜµÍ≥Ñ
                    React.createElement('div', { className: "bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-2xl border mb-6" },
                        React.createElement('div', { className: "flex items-center justify-between" },
                            React.createElement('div', null,
                                React.createElement('p', { className: "text-blue-600 font-medium" }, "Ï¥ù Í∏∞Î°ù"),
                                React.createElement('p', { className: "text-3xl font-bold text-blue-800" }, personalData.stats.totalRecords),
                                React.createElement('p', { className: "text-sm text-blue-600" }, "Î≤à Ï∏°Ï†ï")
                            ),
                            React.createElement('div', null,
                                React.createElement('p', { className: "text-blue-600 font-medium" }, "Î™©Ìëú Î≤îÏúÑ"),
                                React.createElement('p', { className: "text-lg font-bold text-blue-800" }, userSettings.targetMin + ' - ' + userSettings.targetMax),
                                React.createElement('p', { className: "text-sm text-blue-600" }, "mg/dL")
                            )
                        )
                    ),

                    // ÌòàÎãπ ÏûÖÎ†•
                    React.createElement('div', { className: "bg-white p-6 rounded-2xl shadow-lg border mb-6" },
                        React.createElement('h3', { className: "text-lg font-bold text-gray-800 mb-4" }, "ÌòàÎãπ Í∏∞Î°ùÌïòÍ∏∞"),
                        React.createElement('div', { className: "flex gap-3 items-end" },
                            React.createElement('div', { className: "flex-1" },
                                React.createElement('input', {
                                    type: "number",
                                    value: bloodSugar,
                                    onChange: (e) => setBloodSugar(e.target.value),
                                    placeholder: "ÌòàÎãπ ÏàòÏπò (mg/dL)",
                                    className: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-lg"
                                })
                            ),
                            React.createElement('button', {
                                onClick: () => {
                                    if (bloodSugar) {
                                        addBloodSugarRecord(bloodSugar);
                                        setBloodSugar('');
                                    }
                                },
                                disabled: !bloodSugar,
                                className: "bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-6 py-3 rounded-lg font-medium"
                            }, "Í∏∞Î°ùÌïòÍ∏∞")
                        ),
                        bloodSugar && React.createElement('div', { className: 'mt-3 p-3 rounded-lg ' + getBGStatus(bloodSugar).bgColor },
                            React.createElement('p', { className: 'font-medium ' + getBGStatus(bloodSugar).color },
                                getBGStatus(bloodSugar).status + ' ÏÉÅÌÉúÏûÖÎãàÎã§'
                            )
                        )
                    ),

                    // Í∏∞Î°ù Î™©Î°ù
                    React.createElement('div', { className: "bg-white p-6 rounded-2xl shadow-lg border" },
                        React.createElement('h4', { className: "font-bold text-gray-800 mb-4 text-lg" }, "ÎÇ¥ ÌòàÎãπ Í∏∞Î°ù"),
                        React.createElement('div', { className: "space-y-3" },
                            personalData.bloodSugars.length > 0 ? personalData.bloodSugars.slice(-10).reverse().map((record) => {
                                const status = getBGStatus(record.value);
                                return React.createElement('div', { 
                                    key: record.id, 
                                    className: 'flex items-center justify-between p-4 rounded-lg border ' + status.bgColor
                                },
                                    React.createElement('div', { className: "flex-1" },
                                        editingRecord === record.id ? 
                                            React.createElement('div', { className: "flex gap-2" },
                                                React.createElement('input', {
                                                    type: "number",
                                                    defaultValue: record.value,
                                                    className: "px-3 py-1 border border-gray-300 rounded w-24",
                                                    id: 'edit-' + record.id,
                                                    onKeyPress: (e) => {
                                                        if (e.key === 'Enter') {
                                                            editRecord(record.id, e.target.value);
                                                        }
                                                    }
                                                }),
                                                React.createElement('button', {
                                                    onClick: () => {
                                                        const input = document.getElementById('edit-' + record.id);
                                                        editRecord(record.id, input.value);
                                                    },
                                                    className: "text-green-600 hover:text-green-800"
                                                }, React.createElement(Check)),
                                                React.createElement('button', {
                                                    onClick: () => setEditingRecord(null),
                                                    className: "text-gray-600 hover:text-gray-800"
                                                }, React.createElement(X))
                                            ) :
                                            React.createElement('div', null,
                                                React.createElement('p', { className: 'font-bold text-lg ' + status.color }, record.value + ' mg/dL'),
                                                React.createElement('p', { className: "text-sm text-gray-600" }, 
                                                    new Date(record.timestamp).toLocaleString('ko-KR', {
                                                        month: 'short',
                                                        day: 'numeric',
                                                        hour: '2-digit',
                                                        minute: '2-digit'
                                                    })
                                                ),
                                                React.createElement('span', { className: 'text-sm font-medium ' + status.color }, status.status)
                                            )
                                    ),
                                    editingRecord !== record.id && React.createElement('div', { className: "flex gap-2" },
                                        React.createElement('button', {
                                            onClick: () => setEditingRecord(record.id),
                                            className: "p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-lg"
                                        }, React.createElement(Edit)),
                                        React.createElement('button', {
                                            onClick: () => deleteRecord(record.id),
                                            className: "p-2 text-red-600 hover:text-red-800 hover:bg-red-100 rounded-lg"
                                        }, React.createElement(Trash))
                                    )
                                );
                            }) : React.createElement('div', { className: "text-center py-8 text-gray-500" },
                                React.createElement('p', { className: "text-lg" }, "ÏïÑÏßÅ Í∏∞Î°ùÏù¥ ÏóÜÏñ¥Ïöî"),
                                React.createElement('p', { className: "text-sm mt-1" }, "Ï≤´ Î≤àÏß∏ ÌòàÎãπÏùÑ Í∏∞Î°ùÌï¥Î≥¥ÏÑ∏Ïöî!")
                            )
                        )
                    )
                )
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(DiabetesApp));
    </script>
</body>
</html>
